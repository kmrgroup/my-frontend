import{r as C,u as j,l as S,m as k,j as e,C as d,a as h,b as u,c as r,H as F,J as $,K as M,M as _,O as P,Q as T,I as q,d as U,q as H}from"./index-CvaSkwsT.js";import{A as f,b as v}from"./avatar-BmA2OvgG.js";import{M as A}from"./message-square-DV0TJt7J.js";function O(){const[c,p]=C.useState(""),{data:i}=j({queryKey:["/api/friends/1"]}),{data:o}=j({queryKey:["/api/users"],refetchInterval:2e3}),{toast:n}=S(),w=k({mutationFn:async t=>(await U("POST","/api/friends",{userId:1,friendId:t})).json(),onSuccess:()=>{H.invalidateQueries({queryKey:["/api/friends/1"]}),n({title:"Success",description:"Friend request sent successfully!"})},onError:()=>{n({variant:"destructive",title:"Error",description:"Failed to send friend request"})}}),m=t=>{const s={facebook:{appId:"YOUR_FB_APP_ID",redirectUri:`${window.location.origin}/auth/facebook/callback`,scope:"email,public_profile"},twitter:{appId:"YOUR_TWITTER_APP_ID",redirectUri:`${window.location.origin}/auth/twitter/callback`,scope:"tweet.read,users.read"}};if(t==="facebook"){const a=`https://www.facebook.com/v12.0/dialog/oauth?client_id=${s.facebook.appId}&redirect_uri=${encodeURIComponent(s.facebook.redirectUri)}&scope=${s.facebook.scope}`;x(a,t)}else if(t==="twitter"){const a=`https://twitter.com/i/oauth2/authorize?client_id=${s.twitter.appId}&redirect_uri=${encodeURIComponent(s.twitter.redirectUri)}&scope=${s.twitter.scope}&response_type=code`;x(a,t)}},x=(t,s)=>{const g=(window.innerWidth-600)/2,I=(window.innerHeight-800)/2,l=window.open(t,`Connect with ${s}`,`width=600,height=800,left=${g},top=${I}`),y=setInterval(()=>{(!l||l.closed)&&(clearInterval(y),l||n({title:"Connection Failed",description:"Please ensure pop-ups are enabled and try again.",variant:"destructive"}))},1e3)},b=()=>{if(!c.match(/^\+?[\d\s-]{10,}$/)){n({variant:"destructive",title:"Invalid Phone Number",description:"Please enter a valid phone number"});return}n({title:"Invite Sent",description:`Invitation SMS sent to ${c}`}),p("")};return e.jsxs("div",{className:"space-y-6 pb-16 md:pb-0",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Social"}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(d,{children:[e.jsx(h,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Friends"})}),e.jsx(u,{className:"space-y-4",children:i==null?void 0:i.map(t=>e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(f,{children:e.jsx(v,{children:t.friendId.toString()[0]})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Friend #",t.friendId]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.status})]})]})},t.id))})]}),e.jsxs(d,{children:[e.jsx(h,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Invite Friends"})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs(r,{variant:"outline",className:"w-full flex items-center justify-center gap-2",onClick:()=>m("facebook"),children:[e.jsx(F,{className:"h-5 w-5 text-[#1877F2]"}),"Connect with Facebook"]}),e.jsxs(r,{variant:"outline",className:"w-full flex items-center justify-center gap-2",onClick:()=>m("twitter"),children:[e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"Connect with X (Twitter)"]}),e.jsxs($,{children:[e.jsx(M,{asChild:!0,children:e.jsxs(r,{variant:"outline",className:"w-full flex items-center justify-center gap-2",children:[e.jsx(A,{className:"h-5 w-5"}),"Invite via SMS"]})}),e.jsxs(_,{children:[e.jsx(P,{children:e.jsx(T,{children:"Invite via SMS"})}),e.jsxs("div",{className:"space-y-4 pt-4",children:[e.jsx(q,{type:"tel",placeholder:"Enter phone number",value:c,onChange:t=>p(t.target.value)}),e.jsx(r,{className:"w-full",onClick:b,children:"Send Invitation"})]})]})]})]})]})]}),e.jsxs(d,{children:[e.jsx(h,{children:e.jsx("h2",{className:"text-xl font-semibold",children:"Leaderboard"})}),e.jsx(u,{className:"space-y-4",children:o==null?void 0:o.sort((t,s)=>{const a=Number(t.totalMined||0);return Number(s.totalMined||0)-a}).map(t=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(f,{children:e.jsx(v,{children:t.username[0].toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.username}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[Number(t.totalMined||0).toFixed(8)," mined"]})]})]}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>w.mutate(t.id),disabled:i==null?void 0:i.some(s=>s.friendId===t.id),children:i!=null&&i.some(s=>s.friendId===t.id)?"Friends":"Add Friend"})]},t.id))})]})]})]})}export{O as default};
